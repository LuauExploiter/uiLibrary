local Players = game:GetService("Players")
local RS = game:GetService("ReplicatedStorage")
local p = Players.LocalPlayer

local remote = RS:FindFirstChild("Packages") and RS.Packages.Net:FindFirstChild("RE/AdminPanelService/ExecuteCommand")

function SpamNearest()
    if not remote then return end
    local myRoot = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
    if not myRoot then return end

    local nearest, dist = nil, math.huge
    for _, plr in Players:GetPlayers() do
        if plr ~= p and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local d = (plr.Character.HumanoidRootPart.Position - myRoot.Position).Magnitude
            if d < dist then
                dist = d
                nearest = plr
            end
        end
    end

    if nearest then
        for _, cmd in {"rocket", "balloon", "inverse", "tiny"} do
            pcall(function() remote:FireServer(nearest, cmd) end)
            task.wait(0.06)
        end
    end
end
