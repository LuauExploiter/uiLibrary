
local UI = {}

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local GuiParent = LocalPlayer:WaitForChild("PlayerGui")

UI.Theme = {
    Background = Color3.fromRGB(18, 18, 22),
    FrameStroke = Color3.fromRGB(40, 40, 45),
    ButtonPrimary = Color3.fromRGB(139, 188, 255),
    ButtonHover = Color3.fromRGB(150, 198, 255),
    Text = Color3.fromRGB(230, 230, 235),
    Gradient = true,
    Rainbow = false
}

function UI:AddCorner(obj, radius)
    local c = Instance.new("UICorner", obj)
    c.CornerRadius = UDim.new(0, radius or 10)
    return c
end

function UI:Tween(obj, props, dur)
    TweenService:Create(obj, TweenInfo.new(dur or 0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), props):Play()
end

function UI:Create(class, props)
    local obj = Instance.new(class)
    for k,v in pairs(props or {}) do obj[k]=v end
    return obj
end

function UI:MakeDraggable(frame, handle)
    local dragging = false
    local dragInput, mousePos, framePos

    local function update(input)
        local delta = input.Position - mousePos
        frame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X,
                                   framePos.Y.Scale, framePos.Y.Offset + delta.Y)
    end

    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            mousePos = input.Position
            framePos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

function UI:Window(title, size, pos)
    local screenGui = self:Create("ScreenGui", {Parent=GuiParent, ResetOnSpawn=false, ZIndexBehavior=Enum.ZIndexBehavior.Sibling})
    
    local frame = self:Create("Frame", {
        Parent = screenGui,
        Size = size or UDim2.new(0, 360, 0, 200),
        Position = pos or UDim2.new(0, 50, 0, 50),
        BackgroundColor3 = UI.Theme.Background,
        BorderSizePixel = 0
    })
    self:AddCorner(frame, 16)

    local stroke = self:Create("UIStroke", {Parent=frame, Color=UI.Theme.FrameStroke, Thickness=1})
    
    
    local titleLabel = self:Create("TextLabel", {
        Parent = frame,
        Text = title or "UI Window",
        Size = UDim2.new(1, -20, 0, 30),
        Position = UDim2.new(0, 10, 0, 10),
        BackgroundTransparency = 1,
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        TextColor3 = UI.Theme.Text,
        TextXAlignment = Enum.TextXAlignment.Left
    })

    
    local closeBtn = self:Create("TextButton", {
        Parent = frame,
        Text = "X",
        Size = UDim2.new(0, 25, 0, 25),
        Position = UDim2.new(1, -35, 0, 10),
        Font = Enum.Font.GothamBold,
        TextSize = 14,
        TextColor3 = UI.Theme.Text,
        BackgroundColor3 = UI.Theme.ButtonPrimary
    })
    self:AddCorner(closeBtn, 6)
    closeBtn.MouseEnter:Connect(function() self:Tween(closeBtn, {BackgroundColor3=UI.Theme.ButtonHover},0.15) end)
    closeBtn.MouseLeave:Connect(function() self:Tween(closeBtn, {BackgroundColor3=UI.Theme.ButtonPrimary},0.15) end)
    closeBtn.MouseButton1Click:Connect(function() frame.Visible = false end)

    
    self:MakeDraggable(frame, titleLabel)

    
    local tabHolder = self:Create("Frame", {Parent=frame, Size=UDim2.new(1,0,0,30), Position=UDim2.new(0,0,0,40), BackgroundTransparency=1})
    local contentHolder = self:Create("Frame", {Parent=frame, Size=UDim2.new(1,-20,1,-70), Position=UDim2.new(0,10,0,70), BackgroundTransparency=1})

    local tabs, tabButtons = {}, {}

    function frame:Tab(name)
        local tabBtn = UI:Create("TextButton",{Parent=tabHolder, Size=UDim2.new(0,100,1,0), Text=name, Font=Enum.Font.GothamBold, TextSize=14, TextColor3=UI.Theme.Text, BackgroundColor3=UI.Theme.ButtonPrimary})
        UI:AddCorner(tabBtn, 6)
        table.insert(tabButtons, tabBtn)

        local tabContent = UI:Create("Frame", {Parent=contentHolder, Size=UDim2.new(1,0,1,0), BackgroundTransparency=1, Visible=false})
        table.insert(tabs, tabContent)

        tabBtn.MouseButton1Click:Connect(function()
            for _,v in pairs(tabs) do v.Visible=false end
            tabContent.Visible=true
        end)

        local tabAPI = {}

        function tabAPI:Button(text, callback)
            local btn = UI:Create("TextButton",{Parent=tabContent, Size=UDim2.new(1,0,0,35), Text=text, Font=Enum.Font.GothamBold, TextSize=14, TextColor3=UI.Theme.Text, BackgroundColor3=UI.Theme.ButtonPrimary})
            UI:AddCorner(btn,6)
            btn.MouseEnter:Connect(function() UI:Tween(btn, {BackgroundColor3=UI.Theme.ButtonHover},0.15) end)
            btn.MouseLeave:Connect(function() UI:Tween(btn, {BackgroundColor3=UI.Theme.ButtonPrimary},0.15) end)
            if callback then btn.MouseButton1Click:Connect(callback) end
            return btn
        end

        return tabAPI
    end

    return frame
end

return UI
