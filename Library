-- Ultra Modern Roblox UI Library
-- Clean, Professional, and Fully Functional

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local ModernUI = {}
ModernUI.__index = ModernUI

-- Clean Color Scheme
local Colors = {
    Background = Color3.fromRGB(22, 22, 28),
    Foreground = Color3.fromRGB(32, 32, 40),
    Primary = Color3.fromRGB(0, 150, 255),
    Secondary = Color3.fromRGB(140, 85, 255),
    Text = Color3.fromRGB(240, 240, 245),
    SubText = Color3.fromRGB(170, 170, 180),
    Accent = Color3.fromRGB(255, 100, 120),
    Success = Color3.fromRGB(50, 215, 75),
    Border = Color3.fromRGB(50, 50, 60)
}

-- Smooth Animations
local function Tween(obj, properties, duration)
    local tween = TweenService:Create(obj, TweenInfo.new(duration or 0.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), properties)
    tween:Play()
    return tween
end

-- Create Rounded Corners
local function Roundify(obj, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 10)
    corner.Parent = obj
    return corner
end

-- Create Stroke
local function Stroke(obj, thickness, color)
    local stroke = Instance.new("UIStroke")
    stroke.Thickness = thickness or 1
    stroke.Color = color or Colors.Border
    stroke.Parent = obj
    return stroke
end

-- Modern Shadow
local function Shadow(obj)
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Size = UDim2.new(1, 20, 1, 20)
    shadow.Position = UDim2.new(0, -10, 0, -10)
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxassetid://1316045217"
    shadow.ImageColor3 = Color3.new(0, 0, 0)
    shadow.ImageTransparency = 0.5
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(10, 10, 118, 118)
    shadow.ZIndex = -1
    shadow.Parent = obj
    return shadow
end

-- Create Window
function ModernUI:Create(title)
    local self = setmetatable({}, ModernUI)
    
    -- ScreenGui
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "ModernUI_" .. math.random(1000, 9999)
    self.ScreenGui.ResetOnSpawn = false
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
    self.ScreenGui.Parent = game:GetService("CoreGui") or game.Players.LocalPlayer:WaitForChild("PlayerGui")
    
    -- Main Window
    self.Window = Instance.new("Frame")
    self.Window.Name = "Window"
    self.Window.Size = UDim2.new(0, 420, 0, 500)
    self.Window.Position = UDim2.new(0.5, -210, 0.5, -250)
    self.Window.BackgroundColor3 = Colors.Background
    self.Window.BackgroundTransparency = 0
    self.Window.ClipsDescendants = true
    self.Window.Parent = self.ScreenGui
    
    Roundify(self.Window, 14)
    Stroke(self.Window, 2, Colors.Primary)
    Shadow(self.Window)
    
    -- Title Bar
    self.TitleBar = Instance.new("Frame")
    self.TitleBar.Name = "TitleBar"
    self.TitleBar.Size = UDim2.new(1, 0, 0, 45)
    self.TitleBar.BackgroundColor3 = Colors.Foreground
    self.TitleBar.Parent = self.Window
    
    Roundify(self.TitleBar, {TopLeft = 14, TopRight = 14})
    
    -- Title
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Size = UDim2.new(1, -100, 1, 0)
    titleLabel.Position = UDim2.new(0, 15, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title or "Modern UI"
    titleLabel.TextColor3 = Colors.Text
    titleLabel.TextSize = 18
    titleLabel.Font = Enum.Font.GothamSemibold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = self.TitleBar
    
    -- Control Buttons
    local buttonContainer = Instance.new("Frame")
    buttonContainer.Name = "Controls"
    buttonContainer.Size = UDim2.new(0, 50, 1, 0)
    buttonContainer.Position = UDim2.new(1, -55, 0, 0)
    buttonContainer.BackgroundTransparency = 1
    buttonContainer.Parent = self.TitleBar
    
    local layout = Instance.new("UIListLayout")
    layout.FillDirection = Enum.FillDirection.Horizontal
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Right
    layout.VerticalAlignment = Enum.VerticalAlignment.Center
    layout.Padding = UDim.new(0, 8)
    layout.Parent = buttonContainer
    
    -- Minimize Button
    self.MinimizeBtn = Instance.new("ImageButton")
    self.MinimizeBtn.Name = "Minimize"
    self.MinimizeBtn.Size = UDim2.new(0, 18, 0, 18)
    self.MinimizeBtn.BackgroundColor3 = Colors.Secondary
    self.MinimizeBtn.Image = ""
    Roundify(self.MinimizeBtn, 6)
    
    local minimizeIcon = Instance.new("TextLabel")
    minimizeIcon.Size = UDim2.new(1, 0, 1, 0)
    minimizeIcon.BackgroundTransparency = 1
    minimizeIcon.Text = "−"
    minimizeIcon.TextColor3 = Colors.Text
    minimizeIcon.TextSize = 16
    minimizeIcon.Font = Enum.Font.GothamBold
    minimizeIcon.Parent = self.MinimizeBtn
    
    self.MinimizeBtn.Parent = buttonContainer
    
    -- Close Button
    self.CloseBtn = Instance.new("ImageButton")
    self.CloseBtn.Name = "Close"
    self.CloseBtn.Size = UDim2.new(0, 18, 0, 18)
    self.CloseBtn.BackgroundColor3 = Colors.Accent
    self.CloseBtn.Image = ""
    Roundify(self.CloseBtn, 6)
    
    local closeIcon = Instance.new("TextLabel")
    closeIcon.Size = UDim2.new(1, 0, 1, 0)
    closeIcon.BackgroundTransparency = 1
    closeIcon.Text = "×"
    closeIcon.TextColor3 = Colors.Text
    closeIcon.TextSize = 16
    closeIcon.Font = Enum.Font.GothamBold
    closeIcon.Parent = self.CloseBtn
    
    self.CloseBtn.Parent = buttonContainer
    
    -- Tabs Container
    self.TabsContainer = Instance.new("Frame")
    self.TabsContainer.Name = "Tabs"
    self.TabsContainer.Size = UDim2.new(1, -20, 0, 40)
    self.TabsContainer.Position = UDim2.new(0, 10, 0, 50)
    self.TabsContainer.BackgroundTransparency = 1
    self.TabsContainer.Parent = self.Window
    
    local tabsLayout = Instance.new("UIListLayout")
    tabsLayout.FillDirection = Enum.FillDirection.Horizontal
    tabsLayout.Padding = UDim.new(0, 5)
    tabsLayout.Parent = self.TabsContainer
    
    -- Content Area
    self.Content = Instance.new("ScrollingFrame")
    self.Content.Name = "Content"
    self.Content.Size = UDim2.new(1, -20, 1, -105)
    self.Content.Position = UDim2.new(0, 10, 0, 95)
    self.Content.BackgroundTransparency = 1
    self.Content.BorderSizePixel = 0
    self.Content.ScrollBarThickness = 3
    self.Content.ScrollBarImageColor3 = Colors.SubText
    self.Content.AutomaticCanvasSize = Enum.AutomaticSize.Y
    self.Content.ScrollingDirection = Enum.ScrollingDirection.Y
    self.Content.Parent = self.Window
    
    local contentList = Instance.new("UIListLayout")
    contentList.Padding = UDim.new(0, 10)
    contentList.HorizontalAlignment = Enum.HorizontalAlignment.Center
    contentList.Parent = self.Content
    
    -- Setup Dragging
    local dragging = false
    local dragStart, frameStart
    
    local function updateDrag(input)
        local delta = input.Position - dragStart
        self.Window.Position = UDim2.new(
            frameStart.X.Scale,
            frameStart.X.Offset + delta.X,
            frameStart.Y.Scale,
            frameStart.Y.Offset + delta.Y
        )
    end
    
    self.TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            frameStart = self.Window.Position
            
            Tween(self.TitleBar, {BackgroundColor3 = Colors.Foreground:lerp(Colors.Primary, 0.15)}, 0.15)
            
            local connection
            connection = input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                    Tween(self.TitleBar, {BackgroundColor3 = Colors.Foreground}, 0.15)
                    connection:Disconnect()
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            updateDrag(input)
        end
    end)
    
    -- Button Hover Effects
    local function SetupButtonHover(btn, normalColor, hoverColor)
        btn.MouseEnter:Connect(function()
            Tween(btn, {BackgroundColor3 = hoverColor}, 0.15)
        end)
        
        btn.MouseLeave:Connect(function()
            Tween(btn, {BackgroundColor3 = normalColor}, 0.15)
        end)
        
        btn.MouseButton1Down:Connect(function()
            Tween(btn, {Size = UDim2.new(0, 16, 0, 16)}, 0.1)
        end)
        
        btn.MouseButton1Up:Connect(function()
            Tween(btn, {Size = UDim2.new(0, 18, 0, 18)}, 0.1)
        end)
    end
    
    SetupButtonHover(self.MinimizeBtn, Colors.Secondary, Colors.Secondary:lerp(Color3.new(1, 1, 1), 0.2))
    SetupButtonHover(self.CloseBtn, Colors.Accent, Colors.Accent:lerp(Color3.new(1, 1, 1), 0.2))
    
    -- Window Functionality
    local minimized = false
    local originalSize = self.Window.Size
    
    self.MinimizeBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        
        if minimized then
            Tween(self.Window, {Size = UDim2.new(originalSize.X.Scale, originalSize.X.Offset, 0, 45)}, 0.3)
            Tween(self.Content, {Size = UDim2.new(1, -20, 0, 0)}, 0.3)
        else
            Tween(self.Window, {Size = originalSize}, 0.3)
            Tween(self.Content, {Size = UDim2.new(1, -20, 1, -105)}, 0.3)
        end
    end)
    
    self.CloseBtn.MouseButton1Click:Connect(function()
        Tween(self.Window, {Size = UDim2.new(0, 0, 0, 0)}, 0.25)
        Tween(self.Window, {BackgroundTransparency = 1}, 0.25)
        
        task.wait(0.3)
        self.ScreenGui:Destroy()
    end)
    
    self.Tabs = {}
    self.CurrentTab = nil
    
    return self
end

-- Create Tab
function ModernUI:Tab(name)
    local tabButton = Instance.new("TextButton")
    tabButton.Name = name .. "Tab"
    tabButton.Size = UDim2.new(0, 90, 1, 0)
    tabButton.BackgroundColor3 = Colors.Foreground
    tabButton.Text = name
    tabButton.TextColor3 = Colors.SubText
    tabButton.TextSize = 14
    tabButton.Font = Enum.Font.Gotham
    tabButton.Parent = self.TabsContainer
    
    Roundify(tabButton, 8)
    
    -- Tab Content
    local tabContent = Instance.new("Frame")
    tabContent.Name = name .. "Content"
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.BackgroundTransparency = 1
    tabContent.Visible = false
    tabContent.Parent = self.Content
    
    local contentLayout = Instance.new("UIListLayout")
    contentLayout.Padding = UDim.new(0, 10)
    contentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    contentLayout.Parent = tabContent
    
    local tab = {
        Button = tabButton,
        Content = tabContent,
        Name = name,
        Elements = {}
    }
    
    -- Set as current if first tab
    if not self.CurrentTab then
        self.CurrentTab = tab
        tabButton.BackgroundColor3 = Colors.Primary
        tabButton.TextColor3 = Colors.Text
        tabContent.Visible = true
    end
    
    -- Tab Switching
    tabButton.MouseButton1Click:Connect(function()
        if self.CurrentTab == tab then return end
        
        if self.CurrentTab then
            self.CurrentTab.Content.Visible = false
            Tween(self.CurrentTab.Button, {
                BackgroundColor3 = Colors.Foreground,
                TextColor3 = Colors.SubText
            }, 0.15)
        end
        
        self.CurrentTab = tab
        tabContent.Visible = true
        
        Tween(tabButton, {
            BackgroundColor3 = Colors.Primary,
            TextColor3 = Colors.Text
        }, 0.15)
    end)
    
    -- Hover Effect
    tabButton.MouseEnter:Connect(function()
        if self.CurrentTab ~= tab then
            Tween(tabButton, {BackgroundColor3 = Colors.Foreground:lerp(Colors.Primary, 0.3)}, 0.15)
        end
    end)
    
    tabButton.MouseLeave:Connect(function()
        if self.CurrentTab ~= tab then
            Tween(tabButton, {BackgroundColor3 = Colors.Foreground}, 0.15)
        end
    end)
    
    table.insert(self.Tabs, tab)
    
    -- Element Creation Functions
    local tabMethods = {}
    
    function tabMethods:Button(text, callback)
        local buttonFrame = Instance.new("TextButton")
        buttonFrame.Name = "Button_" .. text
        buttonFrame.Size = UDim2.new(1, -20, 0, 42)
        buttonFrame.BackgroundColor3 = Colors.Foreground
        buttonFrame.Text = text
        buttonFrame.TextColor3 = Colors.Text
        buttonFrame.TextSize = 14
        buttonFrame.Font = Enum.Font.GothamSemibold
        buttonFrame.Parent = self.CurrentTab.Content
        
        Roundify(buttonFrame, 10)
        Stroke(buttonFrame, 1, Colors.Primary)
        
        -- Hover Effects
        buttonFrame.MouseEnter:Connect(function()
            Tween(buttonFrame, {
                BackgroundColor3 = Colors.Primary,
                Size = UDim2.new(1, -15, 0, 42)
            }, 0.15)
        end)
        
        buttonFrame.MouseLeave:Connect(function()
            Tween(buttonFrame, {
                BackgroundColor3 = Colors.Foreground,
                Size = UDim2.new(1, -20, 0, 42)
            }, 0.15)
        end)
        
        -- Click Effect
        buttonFrame.MouseButton1Down:Connect(function()
            Tween(buttonFrame, {BackgroundColor3 = Colors.Primary:lerp(Color3.new(1, 1, 1), 0.2)}, 0.1)
        end)
        
        buttonFrame.MouseButton1Up:Connect(function()
            Tween(buttonFrame, {BackgroundColor3 = Colors.Primary}, 0.1)
            if callback then
                callback()
            end
        end)
        
        table.insert(self.CurrentTab.Elements, buttonFrame)
        return buttonFrame
    end
    
    function tabMethods:Toggle(text, default, callback)
        local toggleFrame = Instance.new("Frame")
        toggleFrame.Name = "Toggle_" .. text
        toggleFrame.Size = UDim2.new(1, -20, 0, 40)
        toggleFrame.BackgroundColor3 = Colors.Foreground
        toggleFrame.Parent = self.CurrentTab.Content
        
        Roundify(toggleFrame, 10)
        
        local label = Instance.new("TextLabel")
        label.Name = "Label"
        label.Size = UDim2.new(1, -60, 1, 0)
        label.Position = UDim2.new(0, 15, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = text
        label.TextColor3 = Colors.Text
        label.TextSize = 14
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = toggleFrame
        
        local toggleOuter = Instance.new("Frame")
        toggleOuter.Name = "Toggle"
        toggleOuter.Size = UDim2.new(0, 50, 0, 24)
        toggleOuter.Position = UDim2.new(1, -60, 0.5, -12)
        toggleOuter.BackgroundColor3 = Colors.Border
        toggleOuter.Parent = toggleFrame
        
        Roundify(toggleOuter, 12)
        
        local toggleInner = Instance.new("Frame")
        toggleInner.Name = "ToggleInner"
        toggleInner.Size = UDim2.new(0, 20, 0, 20)
        toggleInner.Position = UDim2.new(0, 2, 0.5, -10)
        toggleInner.BackgroundColor3 = Colors.Primary
        toggleInner.Parent = toggleOuter
        
        Roundify(toggleInner, 10)
        
        local state = default or false
        if state then
            toggleInner.Position = UDim2.new(1, -22, 0.5, -10)
            toggleOuter.BackgroundColor3 = Colors.Primary:lerp(Color3.new(1, 1, 1), 0.3)
        end
        
        local toggleBtn = Instance.new("TextButton")
        toggleBtn.Name = "ToggleButton"
        toggleBtn.Size = UDim2.new(1, 0, 1, 0)
        toggleBtn.BackgroundTransparency = 1
        toggleBtn.Text = ""
        toggleBtn.Parent = toggleFrame
        
        toggleBtn.MouseButton1Click:Connect(function()
            state = not state
            
            if state then
                Tween(toggleInner, {Position = UDim2.new(1, -22, 0.5, -10)}, 0.2)
                Tween(toggleOuter, {BackgroundColor3 = Colors.Primary:lerp(Color3.new(1, 1, 1), 0.3)}, 0.2)
            else
                Tween(toggleInner, {Position = UDim2.new(0, 2, 0.5, -10)}, 0.2)
                Tween(toggleOuter, {BackgroundColor3 = Colors.Border}, 0.2)
            end
            
            if callback then
                callback(state)
            end
        end)
        
        -- Hover Effect
        toggleFrame.MouseEnter:Connect(function()
            Tween(toggleFrame, {BackgroundColor3 = Colors.Foreground:lerp(Colors.Primary, 0.1)}, 0.15)
        end)
        
        toggleFrame.MouseLeave:Connect(function()
            Tween(toggleFrame, {BackgroundColor3 = Colors.Foreground}, 0.15)
        end)
        
        table.insert(self.CurrentTab.Elements, toggleFrame)
        return toggleFrame
    end
    
    function tabMethods:Slider(text, min, max, default, callback)
        local sliderFrame = Instance.new("Frame")
        sliderFrame.Name = "Slider_" .. text
        sliderFrame.Size = UDim2.new(1, -20, 0, 65)
        sliderFrame.BackgroundColor3 = Colors.Foreground
        sliderFrame.Parent = self.CurrentTab.Content
        
        Roundify(sliderFrame, 10)
        
        local label = Instance.new("TextLabel")
        label.Name = "Label"
        label.Size = UDim2.new(1, -20, 0, 20)
        label.Position = UDim2.new(0, 15, 0, 8)
        label.BackgroundTransparency = 1
        label.Text = text
        label.TextColor3 = Colors.Text
        label.TextSize = 14
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = sliderFrame
        
        local valueLabel = Instance.new("TextLabel")
        valueLabel.Name = "Value"
        valueLabel.Size = UDim2.new(0, 50, 0, 20)
        valueLabel.Position = UDim2.new(1, -65, 0, 8)
        valueLabel.BackgroundTransparency = 1
        valueLabel.Text = tostring(default or min)
        valueLabel.TextColor3 = Colors.Primary
        valueLabel.TextSize = 14
        valueLabel.Font = Enum.Font.GothamSemibold
        valueLabel.TextXAlignment = Enum.TextXAlignment.Right
        valueLabel.Parent = sliderFrame
        
        local sliderTrack = Instance.new("Frame")
        sliderTrack.Name = "Track"
        sliderTrack.Size = UDim2.new(1, -30, 0, 6)
        sliderTrack.Position = UDim2.new(0, 15, 0, 40)
        sliderTrack.BackgroundColor3 = Colors.Border
        sliderTrack.Parent = sliderFrame
        
        Roundify(sliderTrack, 3)
        
        local sliderFill = Instance.new("Frame")
        sliderFill.Name = "Fill"
        sliderFill.Size = UDim2.new(0, 0, 1, 0)
        sliderFill.BackgroundColor3 = Colors.Primary
        sliderFill.Parent = sliderTrack
        
        Roundify(sliderFill, 3)
        
        local sliderButton = Instance.new("Frame")
        sliderButton.Name = "SliderButton"
        sliderButton.Size = UDim2.new(0, 20, 0, 20)
        sliderButton.Position = UDim2.new(0, -10, 0.5, -10)
        sliderButton.BackgroundColor3 = Colors.Primary
        sliderButton.ZIndex = 2
        sliderButton.Parent = sliderFill
        
        Roundify(sliderButton, 10)
        Stroke(sliderButton, 2, Color3.new(1, 1, 1))
        
        local currentValue = default or min
        local dragging = false
        
        local function UpdateSlider(value)
            value = math.clamp(value, min, max)
            currentValue = value
            
            local percent = (value - min) / (max - min)
            sliderFill.Size = UDim2.new(percent, 0, 1, 0)
            valueLabel.Text = tostring(math.floor(value))
            
            if callback then
                callback(value)
            end
        end
        
        UpdateSlider(currentValue)
        
        -- Mouse Interactions
        sliderButton.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                Tween(sliderButton, {Size = UDim2.new(0, 22, 0, 22)}, 0.1)
            end
        end)
        
        sliderTrack.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                local mousePos = UserInputService:GetMouseLocation()
                local trackPos = sliderTrack.AbsolutePosition
                local trackSize = sliderTrack.AbsoluteSize
                
                local relativeX = (mousePos.X - trackPos.X) / trackSize.X
                relativeX = math.clamp(relativeX, 0, 1)
                
                local value = min + (relativeX * (max - min))
                UpdateSlider(value)
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local mousePos = UserInputService:GetMouseLocation()
                local trackPos = sliderTrack.AbsolutePosition
                local trackSize = sliderTrack.AbsoluteSize
                
                local relativeX = (mousePos.X - trackPos.X) / trackSize.X
                relativeX = math.clamp(relativeX, 0, 1)
                
                local value = min + (relativeX * (max - min))
                UpdateSlider(value)
            end
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
                Tween(sliderButton, {Size = UDim2.new(0, 20, 0, 20)}, 0.1)
            end
        end)
        
        -- Hover Effect
        sliderFrame.MouseEnter:Connect(function()
            Tween(sliderFrame, {BackgroundColor3 = Colors.Foreground:lerp(Colors.Primary, 0.1)}, 0.15)
        end)
        
        sliderFrame.MouseLeave:Connect(function()
            Tween(sliderFrame, {BackgroundColor3 = Colors.Foreground}, 0.15)
        end)
        
        table.insert(self.CurrentTab.Elements, sliderFrame)
        return sliderFrame
    end
    
    function tabMethods:Textbox(placeholder, callback)
        local textboxFrame = Instance.new("Frame")
        textboxFrame.Name = "Textbox"
        textboxFrame.Size = UDim2.new(1, -20, 0, 45)
        textboxFrame.BackgroundColor3 = Colors.Foreground
        textboxFrame.Parent = self.CurrentTab.Content
        
        Roundify(textboxFrame, 10)
        
        local textbox = Instance.new("TextBox")
        textbox.Name = "Input"
        textbox.Size = UDim2.new(1, -20, 1, -10)
        textbox.Position = UDim2.new(0, 10, 0, 5)
        textbox.BackgroundColor3 = Colors.Background
        textbox.TextColor3 = Colors.Text
        textbox.PlaceholderColor3 = Colors.SubText
        textbox.PlaceholderText = placeholder or "Type here..."
        textbox.Text = ""
        textbox.TextSize = 14
        textbox.Font = Enum.Font.Gotham
        textbox.ClearTextOnFocus = false
        textbox.Parent = textboxFrame
        
        Roundify(textbox, 8)
        
        -- Focus Effects
        textbox.Focused:Connect(function()
            Tween(textbox, {
                BackgroundColor3 = Colors.Primary:lerp(Colors.Background, 0.8),
                Size = UDim2.new(1, -15, 1, -10)
            }, 0.15)
        end)
        
        textbox.FocusLost:Connect(function(enterPressed)
            Tween(textbox, {
                BackgroundColor3 = Colors.Background,
                Size = UDim2.new(1, -20, 1, -10)
            }, 0.15)
            
            if enterPressed and callback then
                callback(textbox.Text)
                textbox.Text = ""
            end
        end)
        
        -- Hover Effect
        textboxFrame.MouseEnter:Connect(function()
            Tween(textboxFrame, {BackgroundColor3 = Colors.Foreground:lerp(Colors.Primary, 0.1)}, 0.15)
        end)
        
        textboxFrame.MouseLeave:Connect(function()
            Tween(textboxFrame, {BackgroundColor3 = Colors.Foreground}, 0.15)
        end)
        
        table.insert(self.CurrentTab.Elements, textboxFrame)
        return textboxFrame
    end
    
    function tabMethods:Dropdown(title, options, callback)
        local dropdownFrame = Instance.new("Frame")
        dropdownFrame.Name = "Dropdown_" .. title
        dropdownFrame.Size = UDim2.new(1, -20, 0, 40)
        dropdownFrame.BackgroundColor3 = Colors.Foreground
        dropdownFrame.ClipsDescendants = true
        dropdownFrame.Parent = self.CurrentTab.Content
        
        Roundify(dropdownFrame, 10)
        
        local dropdownButton = Instance.new("TextButton")
        dropdownButton.Name = "DropdownButton"
        dropdownButton.Size = UDim2.new(1, 0, 0, 40)
        dropdownButton.BackgroundTransparency = 1
        dropdownButton.Text = ""
        dropdownButton.Parent = dropdownFrame
        
        local label = Instance.new("TextLabel")
        label.Name = "Label"
        label.Size = UDim2.new(1, -40, 1, 0)
        label.Position = UDim2.new(0, 15, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = title .. " ▼"
        label.TextColor3 = Colors.Text
        label.TextSize = 14
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = dropdownButton
        
        local optionsFrame = Instance.new("Frame")
        optionsFrame.Name = "Options"
        optionsFrame.Size = UDim2.new(1, 0, 0, 0)
        optionsFrame.Position = UDim2.new(0, 0, 0, 40)
        optionsFrame.BackgroundColor3 = Colors.Background
        optionsFrame.Visible = false
        optionsFrame.Parent = dropdownFrame
        
        Roundify(optionsFrame, 8)
        
        local optionsLayout = Instance.new("UIListLayout")
        optionsLayout.Parent = optionsFrame
        
        local selected = nil
        local open = false
        
        local function ToggleDropdown()
            open = not open
            
            if open then
                dropdownFrame.Size = UDim2.new(1, -20, 0, 40 + (#options * 35))
                optionsFrame.Visible = true
                Tween(optionsFrame, {Size = UDim2.new(1, 0, 0, #options * 35)}, 0.2)
                label.Text = title .. " ▲"
            else
                Tween(optionsFrame, {Size = UDim2.new(1, 0, 0, 0)}, 0.2)
                label.Text = title .. " ▼"
                
                task.wait(0.2)
                if not open then
                    optionsFrame.Visible = false
                    dropdownFrame.Size = UDim2.new(1, -20, 0, 40)
                end
            end
        end
        
        -- Create Options
        for i, option in ipairs(options) do
            local optionBtn = Instance.new("TextButton")
            optionBtn.Name = "Option_" .. option
            optionBtn.Size = UDim2.new(1, 0, 0, 35)
            optionBtn.BackgroundColor3 = Colors.Background
            optionBtn.Text = option
            optionBtn.TextColor3 = Colors.Text
            optionBtn.TextSize = 14
            optionBtn.Font = Enum.Font.Gotham
            optionBtn.Parent = optionsFrame
            
            optionBtn.MouseButton1Click:Connect(function()
                selected = option
                ToggleDropdown()
                
                if callback then
                    callback(option)
                end
            end)
            
            optionBtn.MouseEnter:Connect(function()
                Tween(optionBtn, {BackgroundColor3 = Colors.Foreground}, 0.15)
            end)
            
            optionBtn.MouseLeave:Connect(function()
                Tween(optionBtn, {BackgroundColor3 = Colors.Background}, 0.15)
            end)
        end
        
        dropdownButton.MouseButton1Click:Connect(ToggleDropdown)
        
        -- Close when clicking outside
        UserInputService.InputBegan:Connect(function(input)
            if open and input.UserInputType == Enum.UserInputType.MouseButton1 then
                local mousePos = input.Position
                local framePos = dropdownFrame.AbsolutePosition
                local frameSize = dropdownFrame.AbsoluteSize
                
                if not (mousePos.X >= framePos.X and mousePos.X <= framePos.X + frameSize.X and
                       mousePos.Y >= framePos.Y and mousePos.Y <= framePos.Y + frameSize.Y) then
                    ToggleDropdown()
                end
            end
        end)
        
        -- Hover Effect
        dropdownFrame.MouseEnter:Connect(function()
            Tween(dropdownFrame, {BackgroundColor3 = Colors.Foreground:lerp(Colors.Primary, 0.2)}, 0.15)
        end)
        
        dropdownFrame.MouseLeave:Connect(function()
            if not open then
                Tween(dropdownFrame, {BackgroundColor3 = Colors.Foreground}, 0.15)
            end
        end)
        
        table.insert(self.CurrentTab.Elements, dropdownFrame)
        return dropdownFrame
    end
    
    function tabMethods:MultiSelect(title, options, callback)
        local multiFrame = Instance.new("Frame")
        multiFrame.Name = "MultiSelect_" .. title
        multiFrame.Size = UDim2.new(1, -20, 0, 40)
        multiFrame.BackgroundColor3 = Colors.Foreground
        multiFrame.ClipsDescendants = true
        multiFrame.Parent = self.CurrentTab.Content
        
        Roundify(multiFrame, 10)
        
        local multiButton = Instance.new("TextButton")
        multiButton.Name = "MultiButton"
        multiButton.Size = UDim2.new(1, 0, 0, 40)
        multiButton.BackgroundTransparency = 1
        multiButton.Text = ""
        multiButton.Parent = multiFrame
        
        local label = Instance.new("TextLabel")
        label.Name = "Label"
        label.Size = UDim2.new(1, -40, 1, 0)
        label.Position = UDim2.new(0, 15, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = title .. " ▼"
        label.TextColor3 = Colors.Text
        label.TextSize = 14
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = multiButton
        
        local optionsFrame = Instance.new("Frame")
        optionsFrame.Name = "Options"
        optionsFrame.Size = UDim2.new(1, 0, 0, 0)
        optionsFrame.Position = UDim2.new(0, 0, 0, 40)
        optionsFrame.BackgroundColor3 = Colors.Background
        optionsFrame.Visible = false
        optionsFrame.Parent = multiFrame
        
        Roundify(optionsFrame, 8)
        
        local optionsLayout = Instance.new("UIListLayout")
        optionsLayout.Parent = optionsFrame
        
        local selected = {}
        local open = false
        
        local function UpdateLabel()
            local count = 0
            for _ in pairs(selected) do
                count = count + 1
            end
            
            if count == 0 then
                label.Text = title .. " ▼"
            else
                label.Text = title .. " (" .. count .. ") ▼"
            end
        end
        
        local function ToggleDropdown()
            open = not open
            
            if open then
                multiFrame.Size = UDim2.new(1, -20, 0, 40 + (#options * 35))
                optionsFrame.Visible = true
                Tween(optionsFrame, {Size = UDim2.new(1, 0, 0, #options * 35)}, 0.2)
                label.Text = string.gsub(label.Text, "▼", "▲")
            else
                Tween(optionsFrame, {Size = UDim2.new(1, 0, 0, 0)}, 0.2)
                label.Text = string.gsub(label.Text, "▲", "▼")
                
                task.wait(0.2)
                if not open then
                    optionsFrame.Visible = false
                    multiFrame.Size = UDim2.new(1, -20, 0, 40)
                end
            end
        end
        
        -- Create Options with Checkboxes
        for i, option in ipairs(options) do
            local optionFrame = Instance.new("Frame")
            optionFrame.Name = "Option_" .. option
            optionFrame.Size = UDim2.new(1, 0, 0, 35)
            optionFrame.BackgroundColor3 = Colors.Background
            optionFrame.Parent = optionsFrame
            
            local checkbox = Instance.new("Frame")
            checkbox.Name = "Checkbox"
            checkbox.Size = UDim2.new(0, 20, 0, 20)
            checkbox.Position = UDim2.new(0, 10, 0.5, -10)
            checkbox.BackgroundColor3 = Colors.Border
            checkbox.Parent = optionFrame
            
            Roundify(checkbox, 4)
            
            local checkmark = Instance.new("Frame")
            checkmark.Name = "Checkmark"
            checkmark.Size = UDim2.new(0, 14, 0, 14)
            checkmark.Position = UDim2.new(0, 3, 0, 3)
            checkmark.BackgroundColor3 = Colors.Primary
            checkmark.Visible = false
            checkmark.Parent = checkbox
            
            Roundify(checkmark, 3)
            
            local optionLabel = Instance.new("TextLabel")
            optionLabel.Name = "Label"
            optionLabel.Size = UDim2.new(1, -40, 1, 0)
            optionLabel.Position = UDim2.new(0, 35, 0, 0)
            optionLabel.BackgroundTransparency = 1
            optionLabel.Text = option
            optionLabel.TextColor3 = Colors.Text
            optionLabel.TextSize = 14
            optionLabel.Font = Enum.Font.Gotham
            optionLabel.TextXAlignment = Enum.TextXAlignment.Left
            optionLabel.Parent = optionFrame
            
            local optionBtn = Instance.new("TextButton")
            optionBtn.Name = "Button"
            optionBtn.Size = UDim2.new(1, 0, 1, 0)
            optionBtn.BackgroundTransparency = 1
            optionBtn.Text = ""
            optionBtn.Parent = optionFrame
            
            optionBtn.MouseButton1Click:Connect(function()
                selected[option] = not selected[option]
                
                if selected[option] then
                    checkmark.Visible = true
                    Tween(checkbox, {BackgroundColor3 = Colors.Primary:lerp(Color3.new(1, 1, 1), 0.3)}, 0.2)
                else
                    checkmark.Visible = false
                    Tween(checkbox, {BackgroundColor3 = Colors.Border}, 0.2)
                end
                
                UpdateLabel()
                
                if callback then
                    local selectedList = {}
                    for opt, isSelected in pairs(selected) do
                        if isSelected then
                            table.insert(selectedList, opt)
                        end
                    end
                    callback(selectedList)
                end
            end)
            
            optionBtn.MouseEnter:Connect(function()
                Tween(optionFrame, {BackgroundColor3 = Colors.Foreground}, 0.15)
            end)
            
            optionBtn.MouseLeave:Connect(function()
                Tween(optionFrame, {BackgroundColor3 = Colors.Background}, 0.15)
            end)
        end
        
        multiButton.MouseButton1Click:Connect(ToggleDropdown)
        
        -- Close when clicking outside
        UserInputService.InputBegan:Connect(function(input)
            if open and input.UserInputType == Enum.UserInputType.MouseButton1 then
                local mousePos = input.Position
                local framePos = multiFrame.AbsolutePosition
                local frameSize = multiFrame.AbsoluteSize
                
                if not (mousePos.X >= framePos.X and mousePos.X <= framePos.X + frameSize.X and
                       mousePos.Y >= framePos.Y and mousePos.Y <= framePos.Y + frameSize.Y) then
                    ToggleDropdown()
                end
            end
        end)
        
        UpdateLabel()
        
        table.insert(self.CurrentTab.Elements, multiFrame)
        return multiFrame
    end
    
    return setmetatable(tabMethods, {__index = tabMethods})
end

return ModernUI
