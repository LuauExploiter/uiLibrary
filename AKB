local rs = game:GetService("RunService")
local p = game.Players.LocalPlayer

local conn1, conn2

function AntiKBON()
    if conn1 or conn2 then return end
    local char = p.Character or p.CharacterAdded:Wait()
    local hum = char:WaitForChild("Humanoid")
    local root = char:WaitForChild("HumanoidRootPart")

    for _, v in char:GetDescendants() do
        if v:IsA("BallSocketConstraint") or v:IsA("NoCollisionConstraint") or v:IsA("HingeConstraint") then
            v:Destroy()
        end
    end

    conn1 = hum.StateChanged:Connect(function(_, state)
        if state == Enum.HumanoidStateType.Ragdoll or state == Enum.HumanoidStateType.FallingDown then
            hum:ChangeState(Enum.HumanoidStateType.Running)
        end
    end)

    conn2 = rs.Heartbeat:Connect(function()
        root.AssemblyLinearVelocity = root.AssemblyLinearVelocity.Unit * math.min(root.AssemblyLinearVelocity.Magnitude, 15)
    end)
end

function AntiKBOFF()
    if conn1 then conn1:Disconnect() conn1 = nil end
    if conn2 then conn2:Disconnect() conn2 = nil end
end
